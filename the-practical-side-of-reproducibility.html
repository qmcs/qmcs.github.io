<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

    <title>The practical side of reproducibility</title>

    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


    <meta name="twitter:card" content="summary">

    <meta property="og:type" content="article">


    <link href="http://eecs.io/static/images/favicon.ico" rel="shortcut icon" type="image/x-icon">
    <link href="/apple-touch-icon-precomposed.png" rel="apple-touch-icon">

    <link href="//fonts.googleapis.com/" rel="dns-prefetch">
    <link href="//fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic|Open+Sans:700,400&subset=latin,latin-ext" rel="stylesheet">

    <link rel="stylesheet" href="http://eecs.io/theme/css/main.css" />
    <link rel="stylesheet" href="http://eecs.io/theme/css/pygment.css" />
    <link rel="stylesheet" href="http://eecs.io/theme/css/custom.css" />


    <script src="http://eecs.io/theme/js/jquery.min.js"></script>
    <script src="http://eecs.io/theme/js/modernizr.js"></script>

    <script src="http://eecs.io/theme/js/imageLoader.js"></script>
    <script src="http://eecs.io/theme/js/drawer.js"></script>
    <script src="http://eecs.io/theme/js/scripts.js"></script>


        <link href="http://eecs.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="EECS Society Atom Feed" />

  </head>
  <body class="">


    <button class="drawer-button" id="drawer-button" data-action="open-drawer"><i class="fa fa-bars"></i></button>
    <div class="drawer-overlay"></div>
    <nav class="drawer" tabindex="-1">
      <div class="drawer-container">
        <!--.drawer-search(role="search")-->
        <ul class="drawer-list" role="navigation">

          <li class="drawer-list-item">
            <a data-pjax="" href="http://eecs.io/">
              <i class="fa fa-home"></i>Home
            </a>
          </li>

            <li class="drawer-list-item">
              <a data-pjax="" href="http://eecs.io/archives.html">
                <i class="fa fa-file"></i>Blog
              </a>
            </li>
            <li class="drawer-list-item">
              <a data-pjax="" href="http://eecs.io/authors.html">
                <i class="fa fa-file"></i>People
              </a>
            </li>

          <li class="drawer-list-divider"></li>

            <li class="drawer-list-item drawer-list-title">Pages</li>
              <li class="drawer-list-item">
                <a href="http://eecs.io/pages/about.html">
                  <i class="fa fa-file"></i>About
                </a>
              </li>
              <li class="drawer-list-item">
                <a href="http://eecs.io/events/index.html">
                  <i class="fa fa-file"></i>Events
                </a>
              </li>
              <li class="drawer-list-item">
                <a href="http://eecs.io/pages/reproducibility.html">
                  <i class="fa fa-file"></i>Reproducibility
                </a>
              </li>
              <li class="drawer-list-item">
                <a href="http://eecs.io/pages/scientific-coding-workshop.html">
                  <i class="fa fa-file"></i>Scientific coding workshop
                </a>
              </li>
            <li class="drawer-list-divider"></li>


          <li class="drawer-list-item drawer-list-title">Follow</li>
            <li class="drawer-list-item">
              <a data-pjax="" href="https://www.facebook.com/groups/eecssoc/">
                <i class="fa fa-facebook"></i> Facebook
              </a>
            </li>
            <li class="drawer-list-item">
              <a data-pjax="" href="https://twitter.com/EECSSoc">
                <i class="fa fa-twitter"></i> Twitter
              </a>
            </li>

            <li class="drawer-list-divider"></li>
            <li class="drawer-list-item drawer-list-title">Engage</li>
            <li class="drawer-list-item">
              <a target="_blank" href="https://github.com/qmcs/qmcs.github.io">
                <i class="fa fa-code"></i>Source
              </a>
            </li>

          </ul>
        </div>
      </nav>

    <main id="container" role="main" class="container">
      <div class="surface">
        <div class="surface-container">
          <div data-pjax-container class="content">

<aside role="banner" class="article-cover">
  <div data-load-image="http://eecs.io/static/article_covers/014-salty_vagrant.jpg"  class="cover-image"></div>
  <div class="article-cover-container">
    <a href="http://eecs.io" class="cover-logo" data-pjax>
      <!-- <img src="http://eecs.io/static/images/main.png" alt="Blog Logo"> -->
    </a>
    <h1 class="article-cover-title">The practical side of reproducibility</h1>
<p class="cover-description"><!-- Queen Mary University of London --></p>  </div>
</aside>


<section class="wrapper wrapper-post">
  <div class="wrapper-container">
    <article itemscope itemtype="http://schema.org/BlogPosting" role="article" class="post ">
      <section class="post-container">
        <header class="post-header">
<ul class="post-meta-list">
  <li class="post-meta-item">
    <time datetime="2014-04-06T16:12:00" itemprop="datePublished">
      Sun 06 April 2014
    </time>
  </li>
  <li class="post-meta-item">
      <span itemprop="keywords"><a href="http://eecs.io/tag/vagrant.html">vagrant</a></span>
      <span itemprop="keywords"><a href="http://eecs.io/tag/salt.html">salt</a></span>
      <span itemprop="keywords"><a href="http://eecs.io/tag/deployment.html">deployment</a></span>
  </li>

    <li class="post-meta-item">
      <a href="http://eecs.io/the-practical-side-of-reproducibility.html#disqus_thread">Comments</a>
    </li>

    <li class="post-meta-item">
      <a href="https://github.com/qmcs/qmcs.github.io/edit/pelican/content/articles/014-salty_vagrant.rst">Edit</a>
    </li>
</ul>          <!--h2 itemprop="about" class="post-subtitle"></h2-->
        </header>
        <aside class="post-side">
          <div class="post-author">
              <a href="http://eecs.io/author/dmitrijs-milajevs.html" class="post-author-avatar">
                <img src="http://eecs.io/static/author_images/dmilajevs.jpg" alt="Dmitrijs Milajevs">
              </a>
            <div class="post-author-info">
              <a href="http://eecs.io/author/dmitrijs-milajevs.html" class="post-author-name">
                Dmitrijs Milajevs
              </a>
              <p class="post-author-bio"><p><a class="reference external" href="http://www.eecs.qmul.ac.uk/~dm303/">Dima</a> enjoys programming since he was a
teenager. He is interested in natural language processing.</p>
<p></p>
            </div>
          </div>
        </aside>
        <div itemprop="articleBody" class="post-body">
          <p>In the <a class="reference external" href="http://eecs.io/software-in-your-reproducible-research.html">previous post</a> I pointed out some
difficulties of developing a reproducible experiment. Over a weekend, I've
applied some of that ideas to <a class="reference external" href="http://www.eecs.qmul.ac.uk/~dm303/cvsc14.html">my paper</a> and would like to share my
experience.</p>
<p>This is the second attempt of making this work reproducible. The first was done
by <a class="reference external" href="http://docs.vagrantup.com/v2/boxes.html">Alexander Konovalov</a>, <a class="reference external" href="http://alexk.host.cs.st-andrews.ac.uk">Devasena Inupakutika</a>, <a class="reference external" href="http://www.software.ac.uk/about/people/devasena-inupakutika">Steve Crouch</a> and me at
the <a class="reference external" href="http://www.software.ac.uk/about/people/steve-crouch">Collaborations Workshop</a>. Our aim was to reproduce an experiment and run
it in <a class="reference external" href="http://azure.microsoft.com/">Microsoft Azure</a>.</p>
<p>By that time I'd already had a <a class="reference external" href="http://www.software.ac.uk/collaborations-workshop-2014-cw14-software-your-reproducible-research">Vagrant box</a> that contained all the necessary
software. However, Fedora 20, the OS I used, is not supported by Azure, so we
had to use another OS.</p>
<p>Finally, we managed to create a VM image and run the experiment in the cloud.
However, deployment took most of the time, because we had to install the system
dependencies manually. It was a messy list of development libraries and Python
3.3.</p>
<p></p>
<div class="section" id="automating-things">
<h2>Automating things</h2>
<p>We would spend much less time on deployment if we had an idea what packages we
needed to install. A declarative description of what packages had to be
installed would help us a lot. Luckily, <a class="reference external" href="https://salt.readthedocs.org/en/latest/">salt</a>,  which nicely <a class="reference external" href="http://docs.vagrantup.com/v2/provisioning/salt.html">integrates with
Vagrant</a>, allows to do exactly this.</p>
<p>While vagrant abstracts away all the difficulty and diversity of virtualization
software, salt hides away the quirks of the guest OS. Salt describes the desired
OS configuration as a set of <a class="reference external" href="http://salt.readthedocs.org/en/latest/topics/tutorials/starting_states.html">states</a>. A state can be an installed package, a
file or <a class="reference external" href="http://salt.readthedocs.org/en/v0.17.5/ref/states/all/index.html">almost anything else</a>. In <a class="reference external" href="https://bitbucket.org/dimazest/phd-buildout/src/722ad58af0e3b8a3987758204b9bc78f46395b30/Vagrantfile">my Vagrant setup</a>, I got <a class="reference external" href="https://bitbucket.org/dimazest/phd-buildout/src/722ad58af0e3b8a3987758204b9bc78f46395b30/salt/roots/salt/basic.sls">4 kinds of salt states</a>.</p>
<div class="section" id="system-packages">
<h3>System packages</h3>
<p>The first class of states describes what system packages have to be installed.
Here is the relevant part of the configuration file:</p>
<div class="highlight"><pre><span class="cp">{%</span> <span class="k">set</span> <span class="nv">packages</span> <span class="o">=</span> <span class="o">[</span>
  <span class="s1">&#39;atlas-sse3-devel&#39;</span><span class="o">,</span>
  <span class="s1">&#39;blas-devel&#39;</span><span class="o">,</span>
  <span class="s1">&#39;bzip2-devel&#39;</span><span class="o">,</span>
  <span class="s1">&#39;czmq-devel&#39;</span><span class="o">,</span>
  <span class="s1">&#39;freetype-devel&#39;</span><span class="o">,</span>
  <span class="s1">&#39;gcc-c++&#39;</span><span class="o">,</span>
  <span class="s1">&#39;git&#39;</span><span class="o">,</span>
  <span class="s1">&#39;hdf5-devel&#39;</span><span class="o">,</span>
  <span class="s1">&#39;htop&#39;</span><span class="o">,</span>
  <span class="s1">&#39;libpng-devel&#39;</span><span class="o">,</span>
  <span class="s1">&#39;libyaml-devel&#39;</span><span class="o">,</span>
  <span class="s1">&#39;lzo-devel&#39;</span><span class="o">,</span>
  <span class="s1">&#39;mercurial&#39;</span><span class="o">,</span>
  <span class="s1">&#39;python3&#39;</span><span class="o">,</span>
  <span class="s1">&#39;python3-Cython&#39;</span><span class="o">,</span>
  <span class="s1">&#39;python3-devel&#39;</span><span class="o">,</span>
  <span class="s1">&#39;python3-matplotlib&#39;</span><span class="o">,</span>
  <span class="s1">&#39;python3-numexpr&#39;</span><span class="o">,</span>
  <span class="s1">&#39;python3-numpy&#39;</span><span class="o">,</span>
  <span class="s1">&#39;python3-PyYAML&#39;</span><span class="o">,</span>
  <span class="s1">&#39;python3-scikit-learn&#39;</span><span class="o">,</span>
  <span class="s1">&#39;python3-scipy&#39;</span><span class="o">,</span>
  <span class="s1">&#39;python3-setuptools&#39;</span><span class="o">,</span>
  <span class="s1">&#39;python3-tables&#39;</span><span class="o">,</span>
  <span class="s1">&#39;python3-zmq&#39;</span><span class="o">,</span>
  <span class="s1">&#39;tmux&#39;</span><span class="o">,</span>
  <span class="s1">&#39;unzip&#39;</span><span class="o">,</span>
<span class="o">]</span>
<span class="cp">%}</span><span class="x"></span>

<span class="cp">{%</span> <span class="k">for</span> <span class="nv">pkg</span> <span class="k">in</span> <span class="nv">packages</span> <span class="cp">%}</span><span class="x"></span>
<span class="cp">{{</span> <span class="nv">pkg</span> <span class="cp">}}</span><span class="x">:</span>
<span class="x">  pkg.installed</span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span><span class="x"></span>
</pre></div>
<p>Because salt configuration files are <a class="reference external" href="http://jinja.pocoo.org">Jinja</a> templates, it is possible to avoid
unnecessary repetition and keep the configuration file clear.</p>
<div class="section" id="system-configuration">
<h4>System configuration</h4>
<p>The second set of packages configures the system and leaves some hints on how to
run the experiments. The <tt class="docutils literal">README</tt> file lists the commands needed to be run to
execute experiments presented in the paper.</p>
<div class="highlight"><pre><span class="l-Scalar-Plain">bashrc</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">file.append</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/home/vagrant/.bashrc</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">text</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">export LC_ALL=&quot;en_US.UTF-8&quot;</span>

<span class="l-Scalar-Plain">/etc/motd</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">file.append</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">text</span><span class="p-Indicator">:</span> <span class="p-Indicator">|</span>
        <span class="no">Dialogue act tagging.</span>

        <span class="no">This is an isolated environment to run dialogue act tagging experiments.</span>
        <span class="no">For more details, see http://www.eecs.qmul.ac.uk/~dm303/cvsc14.html</span>

        <span class="no">Check README for further instructions.</span>

<span class="l-Scalar-Plain">README</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">file.copy</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/home/vagrant/README</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">source</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/srv/home/README</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">force</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">true</span>

<span class="l-Scalar-Plain">tmux_conf</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">file.copy</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/home/vagrant/.tmux.conf</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">source</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/srv/home/tmux.conf</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">force</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">true</span>
</pre></div>
</div>
</div>
<div class="section" id="deployment">
<h3>Deployment</h3>
<p>The deployment states retrieve the custom experiment software and deploy it. In
my setup I use buildout. By the way, the same buildout configuration is used for
development, which guarantees that it's up to date.</p>
<div class="highlight"><pre><span class="l-Scalar-Plain">tools</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">hg.latest</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">https://dimazest@bitbucket.org/dimazest/phd-buildout</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">target</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/home/vagrant/tools</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">rev</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">tip</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">runas</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">vagrant</span>

<span class="l-Scalar-Plain">tools_buildout.cfg</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">file.symlink</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/home/vagrant/tools/buildout.cfg</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">target</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/home/vagrant/tools/_buildout.cfg</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">require</span><span class="p-Indicator">:</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">hg</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">tools</span>

<span class="l-Scalar-Plain">tools_buildout_bootstrap</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">cmd.run</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">python3.3 bootstrap.py</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">cwd</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/home/vagrant/tools</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">user</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">vagrant</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">unless</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">ls /home/vagrant/tools/bin/buildout</span>

<span class="l-Scalar-Plain">buildout</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">cmd.run</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">bin/buildout</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">cwd</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/home/vagrant/tools</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">user</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">vagrant</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">env</span><span class="p-Indicator">:</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">LC_ALL</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">en_US.UTF-8</span>
</pre></div>
</div>
<div class="section" id="data">
<h3>Data</h3>
<p>The experiments use several resources. <a class="reference external" href="http://compprag.christopherpotts.net/swda.html">The Switchboard corpus</a>, its typical
training and testing splits and the word vector spaces. All the data is acquired
and put to the right place by salt:</p>
<div class="highlight"><pre><span class="l-Scalar-Plain">swda</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">file.managed</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/home/vagrant/swda.zip</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">source</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">http://compprag.christopherpotts.net/code-data/swda.zip</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">source_hash</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">sha512=fb24f4c5be4e69490535951237a41cd320fe53d7fb2782d3624b0bb99da7a4461ad1ee8bbfeb3e22e38e0b706ae377787d437eb9308d6d32bf16481f7dd1f228</span>

<span class="l-Scalar-Plain">swda_unzip</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">cmd.run</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">yes | unzip swda.zip</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">cwd</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/home/vagrant</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">unless:</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">ls /home/vagrant/swda/</span>

<span class="l-Scalar-Plain">swda_train_split</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">file.managed</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/home/vagrant/downloads/switchboard/ws97-train-convs.list.txt</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">source</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">http://www.eecs.qmul.ac.uk/~dm303/static/papers/cvsc14/ws97-train-convs.list.txt</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">source_hash</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">sha512=d497e4152afc8e3792cfadd0c52ebafad85aea21b65efc5918189a90dfe4aed2604e3d2b6827343d49425b5985a8eb39a3a4729d1c45e572757b4cecb5341bc0</span>

<span class="l-Scalar-Plain">swda_test_split</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">file.managed</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/home/vagrant/downloads/switchboard/ws97-test-convs.list.txt</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">source</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">http://www.eecs.qmul.ac.uk/~dm303/static/papers/cvsc14/ws97-test-convs.list.txt</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">source_hash</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">sha512=cb7e53d3471e63d46b12608db0f2b372c99269a2b7cfa6a4e0997cd7e22d518d5e227a19a572b4de2ce0773434ca5e9ee82022cd88408592dfa16492e3fb0f03</span>

<span class="l-Scalar-Plain">nltk_data</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">cmd.run</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/home/vagrant/tools/bin/fowler.corpora-py -c &quot;import nltk; nltk.download(&#39;all&#39;)&quot;</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">creates</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/home/vagrant/nltk_data</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">user</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">vagrant</span>

<span class="l-Scalar-Plain">cvsc14_space_raw</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">file.managed</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/home/vagrant/data/matrix_swda_c-google-100_3k.h5</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">source</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">http://www.eecs.qmul.ac.uk/~dm303/static/papers/cvsc14/matrix_swda_c-google-100_3k.h5</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">source_hash</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">sha512=c15a9f2d7117305bbcb1b32123e62cfdf0861548d3dc6c2401fd23eeffcb7053c9aa51c16b3ec15236d9aa78385966f92fc5594d77c2ef1066915d20e80d29c4</span>

<span class="l-Scalar-Plain">cvsc14_space_tf_idf</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">file.managed</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/home/vagrant/data/matrix_swda_c-google-100_3k_tf-idf-l2.h5</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">source</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">http://www.eecs.qmul.ac.uk/~dm303/static/papers/cvsc14/matrix_swda_c-google-100_3k_tf-idf-l2.h5</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">source_hash</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">sha512=153572ed754674337a985a8c6ae140cdab73227e2ba74cddad03d13c9e797c32a164b3e917fca43d05bd0238e7a12dce5c5bd24c0f5aec53ed396c31408b023f</span>

<span class="l-Scalar-Plain">cvsc14_space_nmf</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">file.managed</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/home/vagrant/data/matrix_swda_c-google-100_3k_line_normalized_nmf1k.h5</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">source</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">http://www.eecs.qmul.ac.uk/~dm303/static/papers/cvsc14/matrix_swda_c-google-100_3k_line_normalized_nmf1k.h5</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">source_hash</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">sha512=ca14e57e5ceed8073d259088644df6847a9c549b1bad61c9df8563da78ca7f1c239f29b6cbac04091aca90d8c135daff48b7eda8c22b48ffb0cf592f60df6eb5</span>
</pre></div>
<p>As a nice bonus, the checksums are checked to guarantee that you get the same
data as I.</p>
</div>
</div>
<div class="section" id="meta-experiment">
<h2>Meta experiment</h2>
<p>Now, the experiment can be rerun in a few steps:</p>
<div class="highlight"><pre><span class="nv">$ </span>hg clone https://bitbucket.org/dimazest/phd-buildout
<span class="nv">$ </span><span class="nb">cd </span>phd-buildout
<span class="nv">$ </span>vagrant up  <span class="c"># I had to wait for 48 minutes...</span>
<span class="nv">$ </span>vagrant ssh
Last login: Sun Apr  6 14:29:55 2014
Dialogue act tagging.

This is an isolated environment to run dialogue act tagging experiments.
For more details, see http://www.eecs.qmul.ac.uk/~dm303/cvsc14.html

Check README <span class="k">for </span>further instructions.
<span class="o">[</span>vagrant@localhost ~<span class="o">]</span><span class="nv">$ </span>tools/bin/corpora serafin03 plain-lsa  <span class="c"># A nice opportunity for my laptop&#39;s fan to show it&#39;s presence :)</span>
:paper: Serafin et al. 2003
:accuracy: 0.617
:command: tools/bin/corpora serafin03 plain-lsa

<span class="o">====================</span> <span class="o">==========</span> <span class="o">==========</span> <span class="o">==========</span> <span class="o">==========</span>
                 tag  precision     recall   f1-score    <span class="nv">support</span>
<span class="o">====================</span> <span class="o">==========</span> <span class="o">==========</span> <span class="o">==========</span> <span class="o">==========</span>
                   %      0.515      0.694      0.592        360
                  ^2      0.190      0.211      0.200         19
                  ^h      0.200      0.143      0.167          7
                  ^q      0.000      0.000      0.000         17
                  aa      0.515      0.327      0.400        208
             aap<span class="se">\_</span>am      0.000      0.000      0.000          7
                  ad      0.143      0.037      0.059         27
                  ar      0.000      0.000      0.000          3
             arp<span class="se">\_</span>nd      0.000      0.000      0.000          3
                   b      0.764      0.916      0.834        765
                 b^m      0.000      0.000      0.000         21
                  ba      0.529      0.724      0.611         76
                  bd      1.000      1.000      1.000          1
                  bf      0.000      0.000      0.000         23
                  bh      0.480      0.571      0.522         21
                  bk      0.327      0.571      0.416         28
                  br      0.714      0.556      0.625          9
                  fa      0.500      0.500      0.500          2
                  <span class="nb">fc      </span>0.660      0.432      0.522         81
fo<span class="se">\_</span>o<span class="se">\_</span>fw<span class="se">\_</span><span class="err">&quot;</span><span class="se">\_</span>by<span class="se">\_</span>bc      0.250      0.062      0.100         16
                  fp      0.333      0.200      0.250          5
                  ft      0.000      0.000      0.000          7
                   h      0.667      0.609      0.636         23
                  na      0.000      0.000      0.000         10
                  ng      0.500      0.167      0.250          6
                  nn      0.479      0.885      0.622         26
                  no      0.000      0.000      0.000          6
                  ny      0.455      0.068      0.119         73
                  qh      0.250      0.083      0.125         12
                  qo      0.524      0.688      0.595         16
                 qrr      0.250      0.500      0.333          2
                  qw      0.594      0.345      0.437         55
                qw^d      0.000      0.000      0.000          1
                  qy      0.425      0.405      0.415         84
                qy^d      0.308      0.111      0.163         36
                  sd      0.620      0.790      0.695       1317
                  sv      0.568      0.255      0.352        718
                  t1      0.000      0.000      0.000          1
                   x      0.887      1.000      0.940         94
-------------------- ---------- ---------- ---------- ----------
  weighted avg/total      0.592      0.617      0.582       <span class="nv">4186</span>
<span class="o">====================</span> <span class="o">==========</span> <span class="o">==========</span> <span class="o">==========</span> <span class="o">==========</span>

The model is trained on the full development set.
The scores are computed on the full evaluation set.
</pre></div>
</div>
<div class="section" id="future-work">
<h2>Future work</h2>
<p>There are several ways to improve the setup.</p>
<p>So far, I've used Fedora 20 as the guest OS. It's possible to configure salt to
<a class="reference external" href="http://salt.readthedocs.org/en/v0.17.5/topics/tutorials/states_pt3.html#using-grains-in-sls-modules">perform different actions for different OS</a>. For example, it would be nice to
have support for Ubuntu, or even <a class="reference external" href="http://www.gentoo.org/proj/en/gentoo-alt/prefix/">Gentoo prefix</a>.</p>
<p>Adaptation to another provisioner, for example, <a class="reference external" href="http://docs.vagrantup.com/v2/provisioning/docker.html">Docker</a> to minimize isolation
overhead would be another great enhancement.</p>
<p>Nicer data management, probably, using <a class="reference external" href="http://dat-data.com">dat</a> would keep the setup clearer.</p>
<p>Finally, it would be nice to deploy the created virtual machine in a cloud and
run all the experiments there. The trick is that some experiments require quite
a lot of RAM and were originally run on a machine with 16 CPUs and 128 GB of
RAM.</p>
</div>

        </div>
        <footer class="post-footer">
          <div itemprop="author" itemscope itemtype="http://schema.org/Person" class="post-author">
              <a href="http://eecs.io/author/dmitrijs-milajevs.html" class="post-author-avatar">
                <img src="http://eecs.io/static/author_images/dmilajevs.jpg" alt="Dmitrijs Milajevs">
              </a>
            <div class="post-author-info">
              <h4 class="post-footer-heading">Written By</h4>

              <a href="http://eecs.io/author/dmitrijs-milajevs.html" itemprop="url" class="post-author-name">
                <span itemprop="name">Dmitrijs Milajevs</span>
              </a>

              <p itemprop="description" class="post-author-bio"><p><a class="reference external" href="http://www.eecs.qmul.ac.uk/~dm303/">Dima</a> enjoys programming since he was a
teenager. He is interested in natural language processing.</p>
<p></p>

              <p class="post-author-website">
                <a rel="nofollow" href="http://www.eecs.qmul.ac.uk/~dm303/">
                  http://www.eecs.qmul.ac.uk/~dm303/
                </a>
              </p>

                <p class="post-info">
                  <b class="post-info-title">Published in</b>
                  <a href="http://eecs.io/category/reproducibility.html">
                    reproducibility
                  </a>
                </p>

              <p class="post-info">
                <b class="post-info-title">Published on</b>
                <time datetime="2014-04-06T16:12:00" class="post-date">
                  Sun 06 April 2014
                </time>
              </p>

            </div>
          </div>
          <div class="post-social">
            <h4 class="post-footer-heading">Spread the word</h4>
            <a href="#" data-action="share-twitter"><i class="fa fa-fw fa-lg fa-twitter"></i></a>
            <a href="#" data-action="share-facebook"><i class="fa fa-fw fa-lg fa-facebook"></i></a>
            <a href="#" data-action="share-gplus"><i class="fa fa-fw fa-lg fa-google-plus"></i></a>
          </div>
        </footer>
      </section>

  <section class="post-comments">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      var disqus_identifier = "the-practical-side-of-reproducibility.html";
      var disqus_url = "http://eecs.io/the-practical-side-of-reproducibility.html";
      (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://qmcs.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
  </section>

    </article>

<footer class="footer" role="contentinfo">
  <small>
    <p>
      EECS Society | Queen Mary University of London |
        <a href="https://github.com/qmcs/qmcs.github.io/graphs/contributors"> Contributors
    </p>
    <p>
      <a href="https://github.com/qmcs/pelicanium">Pelicanium</a>, a theme based on
      <a href="http://ghostium.oswaldoacauan.com/">Ghostium Theme</a>.
      Proudly powered by  <a href="http://getpelican.com/">Pelican</a>.
    </p>
  </small>
</footer>
  </div>
</section>

          </div>
        </div>
      </div>
    </main>

    <script src="http://eecs.io/theme/js//56c2364f.foot-scripts.min.js"></script>

    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-49253245-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
<script type="text/javascript">
    var disqus_shortname = 'qmcs';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>

  </body>
</html>